@page "/CartSummary"

<div class="w-full px-4 md:px-24">
    <h1 class="title-xl">Resumen de compra</h1>
    <div class="flex justify-between mb-10">
        <h1 class="text-xl font-semibold">Producto</h1>
        <h1 class="text-xl font-semibold">Precio</h1>
        <h1 class="sm:hidden">Cantidad</h1>
        <h1 class="sm:hidden">Total</h1>
    </div>
    @foreach (var shopCart in ShopCarts)
    {
        <div class="flex justify-between pt-2 mt-2">
            <div>
                <div class="inline-flex">
                    <img class="w-24 h-24 rounded-2 mr-2" src="@(shopCart.Url ?? "https://udiscover.mx/cdn/shop/files/big-OR_SIGNEDVINYL-version2.png?v=1691079605")" alt="Imagen del disco">
                    <div class="flex w-64 flex-col pt-2 sm:text-xs md:font-bold text-gray-800">
                        <p class="text-break">@(shopCart.IsMusicCatalog ? shopCart.CatalogMusic.Title : shopCart.AudioCatalog.Name)</p>               
                    </div>
                </div>
            </div>

            <div>
                <div class="flex">
                    @if (shopCart.IsMusicCatalog)
                    {
                        <p class="font-normal text-black">$ @shopCart.GetPrice().ToString("#,##0.00")</p>
                    }
                    else
                    {
                        <p class="font-normal text-black">$ @shopCart.GetPrice().ToString("#,##0.00")</p>
                    }
                </div>
            </div>

            <div class="sm:hidden">
                <div class="flex">
                    <div class="flex w-full md:w-40 border-2 h-10 mb-4">
                        <button class="w-1/3 h-full bg-gray-200">-</button>
                        <input id="cantidad" class="w-1/3 text-center bg-gray-100" type="text" value="1">
                        <button class="w-1/3 h-full bg-gray-200">+</button>
                    </div>
                </div>
            </div>

            <div class="sm:hidden">
                <div class="flex">
                    @if (shopCart.IsMusicCatalog)
                    {
                        <p class="font-normal text-black">$ @shopCart.GetPrice().ToString("#,##0.00")</p>
                    }
                    else
                    {
                        <p class="font-normal text-black">$ @shopCart.GetPrice().ToString("#,##0.00")</p>
                    }
                </div>
            </div>
        </div>
    }
    <hr class="border-gray-300 my-2" />
    <div class="text-end mt-4">
        <div class="justify-between w-1/3 inline-flex">
            <p class="font-bold">Sub Total</p>
            <p>$@(ShopCarts.Sum(x => x.GetPrice()).ToString("#,##0.00"))</p>
        </div>
        <div class="flex justify-end mt-5">
            <AuthorizeView>
                <Authorized>
                    <button @onclick="CreateCheckoutSesion" class="w-1/3 mt-3 h-10 border rounded-xl font-semibold text-white bg-blue-600 text-sm">Pagar</button>
                </Authorized>
                <NotAuthorized>
                    <button @onclick="@(() => NavigationManager.NavigateTo("Identity/Account/Register", forceLoad: true))" class="w-1/3 mt-3 h-10 border rounded-xl font-semibold text-white bg-blue-600 text-sm">Pagar</button>
                </NotAuthorized>
            </AuthorizeView>
        </div>
    </div>

    <div class="my-3 mx-2">
        <h1 class="title-xl">RECOMENDACIONES</h1>
        <hr class="border-gray-300 my-2" />
        <div class="overflow-y-auto">
            <div class="inline-flex space-x-4 px-3">
                @foreach (var item in MusicCatalogs)
                {
                    <CardCatalogMusic MusicCatalog="item"></CardCatalogMusic>
                }
            </div>
        </div>
    </div>
</div>